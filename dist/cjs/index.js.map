{"version":3,"file":"index.js","sources":["../../node_modules/tslib/tslib.es6.js","../../src/rmrk1.0.0/classes/collection.ts","../../src/rmrk1.0.0/classes/nft.ts","../../src/rmrk1.0.0/classes/changeissuer.ts","../../src/rmrk1.0.0/classes/send.ts","../../src/rmrk1.0.0/classes/emote.ts","../../src/tools/utils.ts","../../src/tools/types.ts","../../src/tools/consolidator/consolidator.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","// @todo: add data!\nimport { Change } from \"../changelog\";\n\nexport class Collection {\n  readonly block: number;\n  readonly name: string;\n  readonly max: number;\n  issuer: string;\n  readonly symbol: string;\n  readonly id: string;\n  readonly metadata: string;\n  static V = \"RMRK1.0.0\";\n  private changes: Change[] = [];\n  loadedMetadata?: CollectionMetadata;\n\n  constructor(\n    block: number,\n    name: string,\n    max: number,\n    issuer: string,\n    symbol: string,\n    id: string,\n    metadata: string\n  ) {\n    this.block = block;\n    this.name = name;\n    this.max = max;\n    this.issuer = issuer;\n    this.symbol = symbol;\n    this.id = id;\n    this.metadata = metadata;\n  }\n\n  public mint(): string {\n    if (this.block) {\n      throw new Error(\"An already existing collection cannot be minted!\");\n    }\n    return `RMRK::MINT::${Collection.V}::${encodeURIComponent(\n      JSON.stringify({\n        name: this.name,\n        max: this.max,\n        issuer: this.issuer,\n        symbol: this.symbol.toUpperCase(),\n        id: this.id,\n        metadata: this.metadata,\n      })\n    )}`;\n  }\n\n  public change_issuer(address: string): string {\n    if (this.block === 0) {\n      throw new Error(\n        \"This collection is new, so there's no issuer to change.\" +\n          \" If it has been deployed on chain, load the existing \" +\n          \"collection as a new instance first, then change issuer.\"\n      );\n    }\n    return `RMRK::CHANGEISSUER::${Collection.V}::${this.id}::${address}`;\n  }\n\n  public addChange(c: Change): Collection {\n    this.changes.push(c);\n    return this;\n  }\n\n  public getChanges(): Change[] {\n    return this.changes;\n  }\n\n  static generateId(pubkey: string, symbol: string): string {\n    if (!pubkey.startsWith(\"0x\")) {\n      throw new Error(\"This is not a valid pubkey, it does not start with 0x\");\n    }\n    //console.log(pubkey);\n    return (\n      pubkey.substr(2, 10) +\n      pubkey.substring(pubkey.length - 8) +\n      \"-\" +\n      symbol.toUpperCase()\n    );\n  }\n\n  static fromRemark(remark: string, block?: number): Collection | string {\n    if (!block) {\n      block = 0;\n    }\n    const exploded = remark.split(\"::\");\n    try {\n      if (exploded[0].toUpperCase() != \"RMRK\")\n        throw new Error(\"Invalid remark - does not start with RMRK\");\n      if (exploded[1] != \"MINT\")\n        throw new Error(\"The op code needs to be MINT, is \" + exploded[1]);\n      if (exploded[2] != Collection.V) {\n        throw new Error(\n          `This remark was issued under version ${exploded[2]} instead of ${Collection.V}`\n        );\n      }\n      const data = decodeURIComponent(exploded[3]);\n      const obj = JSON.parse(data);\n      if (!obj) throw new Error(`Could not parse object from: ${data}`);\n      if (\n        undefined === obj.metadata ||\n        (!obj.metadata.startsWith(\"ipfs\") && !obj.metadata.startsWith(\"http\"))\n      )\n        throw new Error(`Invalid metadata - not an HTTP or IPFS URL`);\n      if (undefined === obj.name) throw new Error(`Missing field: name`);\n      if (undefined === obj.max) throw new Error(`Missing field: max`);\n      if (undefined === obj.issuer) throw new Error(`Missing field: issuer`);\n      if (undefined === obj.symbol) throw new Error(`Missing field: symbol`);\n      if (undefined === obj.id) throw new Error(`Missing field: id`);\n      return new this(\n        block,\n        obj.name,\n        obj.max,\n        obj.issuer,\n        obj.symbol,\n        obj.id,\n        obj.metadata\n      );\n    } catch (e) {\n      console.error(e.message);\n      console.log(`MINT error: full input was ${remark}`);\n      return e.message;\n    }\n  }\n\n  /**\n   * TBD - hard dependency on Axios / IPFS to fetch remote\n   */\n  private async load_metadata(): Promise<CollectionMetadata> {\n    if (this.loadedMetadata) return this.loadedMetadata;\n    return {} as CollectionMetadata;\n  }\n}\n\nexport interface CollectionMetadata {\n  description?: string;\n  attributes: Attribute[];\n  external_url?: string;\n  image?: string;\n  image_data?: string;\n}\n\nexport interface Attribute {\n  display_type: DisplayType;\n  trait_type: string;\n  value: number | string;\n}\n\nexport enum DisplayType {\n  null,\n  \"boost_number\",\n  \"number\",\n  \"boost_percentage\",\n}\n","// @todo add data field\nimport { Change } from \"../changelog\";\n\nexport class NFT {\n  readonly block: number;\n  readonly collection: string;\n  readonly name: string;\n  readonly instance: string;\n  readonly transferable: number;\n  readonly data?: string;\n  readonly sn: string;\n  readonly metadata?: string;\n  reactions: Reactionmap;\n  private changes: Change[] = [];\n  owner: string;\n  static V = \"RMRK1.0.0\";\n  loadedMetadata?: NFTMetadata;\n  constructor(\n    block: number,\n    collection: string,\n    name: string,\n    instance: string,\n    transferable: number,\n    sn: string,\n    metadata?: string,\n    data?: string\n  ) {\n    this.block = block;\n    this.collection = collection;\n    this.name = name;\n    this.instance = instance;\n    this.transferable = transferable;\n    this.sn = sn;\n    this.data = data;\n    this.metadata = metadata;\n    this.owner = \"\";\n    this.reactions = {};\n  }\n\n  public getId(): string {\n    if (!this.block)\n      throw new Error(\"This token is not minted, so it cannot have an ID.\");\n    return `${this.block}-${this.collection}-${this.instance}-${this.sn}`;\n  }\n\n  public addChange(c: Change): NFT {\n    this.changes.push(c);\n    return this;\n  }\n\n  public mintnft(): string {\n    if (this.block) {\n      throw new Error(\"An already existing NFT cannot be minted!\");\n    }\n    return `RMRK::MINTNFT::${NFT.V}::${encodeURIComponent(\n      JSON.stringify({\n        collection: this.collection,\n        name: this.name,\n        instance: this.instance,\n        transferable: this.transferable,\n        sn: this.sn,\n        metadata: this.metadata,\n      })\n    )}`;\n  }\n\n  public send(recipient: string): string {\n    if (!this.block) {\n      throw new Error(\n        `You can only send an existing NFT. If you just minted this, please load a new, \n        separate instance as the block number is an important part of an NFT's ID.`\n      );\n    }\n    return `RMRK::SEND::${NFT.V}::${this.getId()}::${recipient}`;\n  }\n\n  // @todo build this out, maybe data type?\n  static checkDataFormat(data: string): boolean {\n    return true;\n  }\n\n  static fromRemark(remark: string, block?: number): NFT | string {\n    if (!block) {\n      block = 0;\n    }\n    const exploded = remark.split(\"::\");\n    try {\n      if (exploded[0].toUpperCase() != \"RMRK\")\n        throw new Error(\"Invalid remark - does not start with RMRK\");\n      if (exploded[1] != \"MINTNFT\")\n        throw new Error(\"The op code needs to be MINTNFT, is \" + exploded[1]);\n      if (exploded[2] != NFT.V) {\n        throw new Error(\n          `This remark was issued under version ${exploded[2]} instead of ${NFT.V}`\n        );\n      }\n      const data = decodeURIComponent(exploded[3]);\n      const obj = JSON.parse(data);\n      if (!obj) throw new Error(`Could not parse object from: ${data}`);\n      // Check if the object has either data or metadata\n      if (\n        (undefined === obj.metadata ||\n          (!obj.metadata.startsWith(\"ipfs\") &&\n            !obj.metadata.startsWith(\"http\"))) &&\n        undefined === obj.data\n      )\n        throw new Error(\n          `Invalid metadata (not an HTTP or IPFS URL) and missing data`\n        );\n      if (obj.data) {\n        NFT.checkDataFormat(obj.data);\n      }\n      if (undefined === obj.name) throw new Error(`Missing field: name`);\n      if (undefined === obj.collection)\n        throw new Error(`Missing field: collection`);\n      if (undefined === obj.instance)\n        throw new Error(`Missing field: instance`);\n      if (undefined === obj.transferable)\n        throw new Error(`Missing field: transferable`);\n      if (undefined === obj.sn) throw new Error(`Missing field: sn`);\n      return new this(\n        block,\n        obj.collection,\n        obj.name,\n        obj.instance,\n        obj.transferable,\n        obj.sn,\n        obj.metadata,\n        obj.data\n      );\n    } catch (e) {\n      console.error(e.message);\n      console.log(`MINTNFT error: full input was ${remark}`);\n      return e.message;\n    }\n  }\n\n  /**\n   * @param price In plancks, so 10000000000 for 0.01 KSM. Set to 0 if canceling listing.\n   */\n  public list(price: number): string {\n    if (!this.block) {\n      throw new Error(\n        `You can only list an existing NFT. If you just minted this, please load a new, \n        separate instance as the block number is an important part of an NFT's ID.`\n      );\n    }\n    return `RMRK::LIST::${NFT.V}::${this.getId()}::${\n      price > 0 ? price : \"cancel\"\n    }`;\n  }\n\n  public buy(): string {\n    if (!this.block) {\n      throw new Error(\n        `You can only buy an existing NFT. If you just minted this, please load a new, \n        separate instance as the block number is an important part of an NFT's ID.`\n      );\n    }\n    return `RMRK::BUY::${NFT.V}::${this.getId()}`;\n  }\n\n  public consume(): string {\n    if (!this.block) {\n      throw new Error(\n        `You can only consume an existing NFT. If you just minted this, please load a new, \n        separate instance as the block number is an important part of an NFT's ID.`\n      );\n    }\n    return `RMRK::CONSUME::${NFT.V}::${this.getId()}`;\n  }\n\n  /**\n   * TBD - hard dependency on Axios / IPFS to fetch remote\n   */\n  private async load_metadata(): Promise<NFTMetadata> {\n    if (this.loadedMetadata) return this.loadedMetadata;\n    return {} as NFTMetadata;\n  }\n}\n\nexport interface NFTMetadata {\n  external_url?: string;\n  image?: string;\n  image_data?: string;\n  description?: string;\n  name?: string;\n  attributes: Attribute[];\n  background_color?: string;\n  animation_url?: string;\n  youtube_url?: string;\n}\n\nexport interface Attribute {\n  display_type: DisplayType;\n  trait_type: string;\n  value: number | string;\n}\n\nexport enum DisplayType {\n  null,\n  \"boost_number\",\n  \"number\",\n  \"boost_percentage\",\n}\n\nexport interface Reactionmap {\n  [unicode: string]: string[];\n}\n","export class ChangeIssuer {\n  issuer: string;\n  id: string;\n  static V = \"RMRK1.0.0\";\n\n  constructor(issuer: string, id: string) {\n    this.issuer = issuer;\n    this.id = id;\n  }\n\n  static fromRemark(remark: string): ChangeIssuer | string {\n    const exploded = remark.split(\"::\");\n    try {\n      if (exploded[0] != \"RMRK\")\n        throw new Error(\"Invalid remark - does not start with RMRK\");\n      if (exploded[2] != ChangeIssuer.V)\n        throw new Error(\n          `Version mismatch. Is ${exploded[2]}, should be ${ChangeIssuer.V}`\n        );\n      if (exploded[1] != \"CHANGEISSUER\")\n        throw new Error(\n          \"The op code needs to be CHANGEISSUER, is \" + exploded[1]\n        );\n\n      if (undefined === exploded[3] || undefined == exploded[4]) {\n        throw new Error(\"Cound not find ID or new issuer\");\n      }\n    } catch (e) {\n      console.error(e.message);\n      console.log(`CHANGEISSUER error: full input was ${remark}`);\n      return e.message;\n    }\n    const ci = new ChangeIssuer(exploded[4], exploded[3]);\n    return ci;\n  }\n}\n","export class Send {\n  recipient: string;\n  id: string;\n  static V = \"RMRK1.0.0\";\n\n  constructor(id: string, recipient: string) {\n    this.recipient = recipient;\n    this.id = id;\n  }\n\n  static fromRemark(remark: string): Send | string {\n    const exploded = remark.split(\"::\");\n    try {\n      if (exploded[0] != \"RMRK\")\n        throw new Error(\"Invalid remark - does not start with RMRK\");\n      if (exploded[2] != Send.V)\n        throw new Error(\n          `Version mismatch. Is ${exploded[2]}, should be ${Send.V}`\n        );\n      if (exploded[1] != \"SEND\")\n        throw new Error(\"The op code needs to be SEND, is \" + exploded[1]);\n\n      if (undefined === exploded[3] || undefined == exploded[4]) {\n        throw new Error(\"Cound not find ID or recipient\");\n      }\n    } catch (e) {\n      console.error(e.message);\n      console.log(`SEND error: full input was ${remark}`);\n      return e.message;\n    }\n    return new Send(exploded[3], exploded[4]);\n  }\n}\n","export class Emote {\n  unicode: string;\n  id: string;\n  static V = \"RMRK1.0.0\";\n\n  constructor(id: string, unicode: string) {\n    this.unicode = unicode;\n    this.id = id;\n  }\n\n  static fromRemark(remark: string): Emote | string {\n    const exploded = remark.split(\"::\");\n    try {\n      if (exploded[0] != \"RMRK\")\n        throw new Error(\"Invalid remark - does not start with RMRK\");\n      if (exploded[2] != Emote.V)\n        throw new Error(\n          `Version mismatch. Is ${exploded[2]}, should be ${Emote.V}`\n        );\n      if (exploded[1] != \"EMOTE\")\n        throw new Error(\"The op code needs to be EMOTE, is \" + exploded[1]);\n\n      if (undefined === exploded[3] || undefined == exploded[4]) {\n        throw new Error(\"Cound not find ID or unicode\");\n      }\n    } catch (e) {\n      console.error(e.message);\n      console.log(`EMOTE error: full input was ${remark}`);\n      return e.message;\n    }\n    return new Emote(exploded[3], exploded[4]);\n  }\n}\n","import { ApiPromise, WsProvider } from \"@polkadot/api\";\nimport { stringToHex } from \"@polkadot/util\";\nimport { URL } from \"url\";\n\nexport const getApi = async (wsEndpoint: string): Promise<ApiPromise> => {\n  const wsProvider = new WsProvider(wsEndpoint);\n  const api = ApiPromise.create({ provider: wsProvider });\n  return api;\n};\n\nexport const getLatestBlock = async (api: ApiPromise): Promise<number> => {\n  const header = await api.rpc.chain.getHeader();\n  return header.number.toNumber();\n};\n\nexport const getLatestFinalizedBlock = async (\n  api: ApiPromise\n): Promise<number> => {\n  const hash = await api.rpc.chain.getFinalizedHead();\n  const header = await api.rpc.chain.getHeader(hash);\n  if (header.number.toNumber() === 0) {\n    console.error(\"Unable to retrieve finalized head - returned genesis block\");\n    process.exit(1);\n  }\n  return header.number.toNumber();\n};\n\nexport const deeplog = function (obj: any): void {\n  console.log(JSON.stringify(obj, null, 2));\n};\n\nexport const stringIsAValidUrl = (s: string): boolean => {\n  try {\n    new URL(s);\n    return true;\n  } catch (err) {\n    return false;\n  }\n};\n\nexport const prefixToArray = function (prefix: string): string[] {\n  const returnArray = [];\n  const exploded = prefix.split(\",\");\n  for (const p of exploded) {\n    if (p.indexOf(\"0x\") === 0) {\n      returnArray.push(p);\n    } else {\n      returnArray.push(stringToHex(p));\n    }\n  }\n  return returnArray;\n};\n","export type Options = {\n  ws: string;\n  from: string;\n  to: string;\n  prefixes: string;\n  blocks: string;\n  json: string;\n  folder: string;\n  append: string;\n  remark: string;\n};\n\nexport type BlockCalls = {\n  block: number;\n  calls: BlockCall[];\n};\n\nexport type BlockCall = {\n  call: string;\n  value: string;\n  caller: string;\n};\n\nexport enum OP_TYPES {\n  BUY = \"BUY\",\n  LIST = \"LIST\",\n  MINT = \"MINT\",\n  MINTNFT = \"MINTNFT\",\n  SEND = \"SEND\",\n  EMOTE = \"EMOTE\",\n  CHANGEISSUER = \"CHANGEISSUER\",\n}\n","import JsonAdapter from \"./adapters/json\";\nimport { Collection as C100 } from \"../../rmrk1.0.0/classes/collection\";\nimport { NFT as N100 } from \"../../rmrk1.0.0/classes/nft\";\nimport { ChangeIssuer } from \"../../rmrk1.0.0/classes/changeissuer\";\nimport { Send } from \"../../rmrk1.0.0/classes/send\";\nimport { Emote } from \"../../rmrk1.0.0/classes/emote\";\nimport { Change } from \"../../rmrk1.0.0/changelog\";\nimport { deeplog } from \"../utils\";\nimport { decodeAddress } from \"@polkadot/keyring\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { Remark } from \"./remark\";\nimport { OP_TYPES } from \"../types\";\n// import * as fs from \"fs\";\n\nexport class Consolidator {\n  private adapter: JsonAdapter;\n  private invalidCalls: InvalidCall[];\n  private collections: C100[];\n  private nfts: N100[];\n  constructor(initializedAdapter: JsonAdapter) {\n    this.adapter = initializedAdapter;\n    this.invalidCalls = [];\n    this.collections = [];\n    this.nfts = [];\n  }\n  private findExistingCollection(id: string) {\n    return this.collections.find((el) => el.id === id);\n  }\n  private updateInvalidCalls(op_type: OP_TYPES, remark: Remark) {\n    const invalidCallBase: Partial<InvalidCall> = {\n      op_type,\n      block: remark.block,\n      caller: remark.caller,\n    };\n    return function update(\n      this: Consolidator,\n      object_id: string,\n      message: string\n    ) {\n      this.invalidCalls.push({\n        ...invalidCallBase,\n        object_id,\n        message,\n      } as InvalidCall);\n    };\n  }\n  private mint(remark: Remark): boolean {\n    // A new collection was created\n    console.log(\"Instantiating collection\");\n    const invalidate = this.updateInvalidCalls(OP_TYPES.MINT, remark).bind(\n      this\n    );\n    const c = C100.fromRemark(remark.remark, remark.block);\n\n    if (typeof c === \"string\") {\n      // console.log(\n      //   \"Collection was not instantiated OK from \" + remark.remark\n      // );\n      invalidate(\n        remark.remark,\n        `[${OP_TYPES.MINT}] Dead before instantiation: ${c}`\n      );\n      return true;\n    }\n\n    //console.log(\"Collection instantiated OK from \" + remark.remark);\n    const pubkey = decodeAddress(remark.caller);\n    const id = C100.generateId(u8aToHex(pubkey), c.symbol);\n\n    if (this.findExistingCollection(c.id)) {\n      invalidate(\n        c.id,\n        `[${OP_TYPES.MINT}] Attempt to mint already existing collection`\n      );\n      return true;\n    }\n\n    if (id.toLowerCase() !== c.id.toLowerCase()) {\n      invalidate(\n        c.id,\n        `Caller's pubkey ${u8aToHex(\n          pubkey\n        )} (${id}) does not match generated ID`\n      );\n      return true;\n    }\n\n    this.collections.push(c);\n    return false;\n  }\n\n  private mintNFT(remark: Remark): boolean {\n    // A new NFT was minted into a collection\n    console.log(\"Instantiating nft\");\n    const invalidate = this.updateInvalidCalls(OP_TYPES.MINTNFT, remark).bind(\n      this\n    );\n    const n = N100.fromRemark(remark.remark, remark.block);\n\n    if (typeof n === \"string\") {\n      invalidate(\n        remark.remark,\n        `[${OP_TYPES.MINTNFT}] Dead before instantiation: ${n}`\n      );\n      return true;\n    }\n\n    const nftParent = this.findExistingCollection(n.collection);\n    if (!nftParent) {\n      invalidate(\n        n.getId(),\n        `NFT referencing non-existant parent collection ${n.collection}`\n      );\n      return true;\n    }\n\n    n.owner = nftParent.issuer;\n    if (remark.caller != n.owner) {\n      invalidate(\n        n.getId(),\n        `Attempted issue of NFT in non-owned collection. Issuer: ${nftParent.issuer}, caller: ${remark.caller}`\n      );\n      return true;\n    }\n\n    const existsCheck = this.nfts.find((el) => {\n      const idExpand1 = el.getId().split(\"-\");\n      idExpand1.shift();\n      const uniquePart1 = idExpand1.join(\"-\");\n\n      const idExpand2 = n.getId().split(\"-\");\n      idExpand2.shift();\n      const uniquePart2 = idExpand2.join(\"-\");\n\n      return uniquePart1 === uniquePart2;\n    });\n\n    if (existsCheck) {\n      invalidate(\n        n.getId(),\n        `[${OP_TYPES.MINTNFT}] Attempt to mint already existing NFT`\n      );\n      return true;\n    }\n    if (n.owner === \"\") {\n      invalidate(\n        n.getId(),\n        `[${OP_TYPES.MINTNFT}] Somehow this NFT still doesn't have an owner.`\n      );\n      return true;\n    }\n    this.nfts.push(n);\n    return false;\n  }\n\n  private send(remark: Remark): boolean {\n    // An NFT was sent to a new owner\n    console.log(\"Instantiating send\");\n    const send = Send.fromRemark(remark.remark);\n    const invalidate = this.updateInvalidCalls(OP_TYPES.SEND, remark).bind(\n      this\n    );\n    if (typeof send === \"string\") {\n      invalidate(\n        remark.remark,\n        `[${OP_TYPES.SEND}] Dead before instantiation: ${send}`\n      );\n      return true;\n    }\n\n    const nft = this.nfts.find((el) => {\n      const idExpand1 = el.getId().split(\"-\");\n      idExpand1.shift();\n      const uniquePart1 = idExpand1.join(\"-\");\n\n      const idExpand2 = send.id.split(\"-\");\n      idExpand2.shift();\n      const uniquePart2 = idExpand2.join(\"-\");\n\n      return uniquePart1 === uniquePart2;\n    });\n\n    // @todo add condition for transferable!\n\n    if (!nft) {\n      invalidate(\n        send.id,\n        `[${OP_TYPES.SEND}] Attempting to send non-existant NFT ${send.id}`\n      );\n      return true;\n    }\n\n    // Check if allowed to issue send - if owner == caller\n    if (nft.owner != remark.caller) {\n      invalidate(\n        send.id,\n        `[${OP_TYPES.SEND}] Attempting to send non-owned NFT ${send.id}, real owner: ${nft.owner}`\n      );\n      return true;\n    }\n\n    nft.addChange({\n      field: \"owner\",\n      old: nft.owner,\n      new: send.recipient,\n      caller: remark.caller,\n      block: remark.block,\n    } as Change);\n\n    nft.owner = send.recipient;\n    return false;\n  }\n\n  private emote(remark: Remark): boolean {\n    // An EMOTE reaction has been sent\n    console.log(\"Instantiating emote\");\n    const emote = Emote.fromRemark(remark.remark);\n    const invalidate = this.updateInvalidCalls(OP_TYPES.EMOTE, remark).bind(\n      this\n    );\n    if (typeof emote === \"string\") {\n      invalidate(\n        remark.remark,\n        `[${OP_TYPES.EMOTE}] Dead before instantiation: ${emote}`\n      );\n      return true;\n    }\n    const target = this.nfts.find((el) => el.getId() === emote.id);\n    if (!target) {\n      invalidate(\n        emote.id,\n        `[${OP_TYPES.EMOTE}] Attempting to emote on non-existant NFT ${emote.id}`\n      );\n      return true;\n    }\n    const index = target.reactions[emote.unicode].indexOf(remark.caller, 0);\n    if (index > -1) {\n      target.reactions[emote.unicode].splice(index, 1);\n    } else {\n      target.reactions[emote.unicode].push(remark.caller);\n    }\n    return false;\n  }\n\n  private changeIssuer(remark: Remark): boolean {\n    // The ownership of a collection has changed\n    console.log(\"Instantiating an issuer change\");\n    const ci = ChangeIssuer.fromRemark(remark.remark);\n    const invalidate = this.updateInvalidCalls(\n      OP_TYPES.CHANGEISSUER,\n      remark\n    ).bind(this);\n    if (typeof ci === \"string\") {\n      // console.log(\n      //   \"ChangeIssuer was not instantiated OK from \" + remark.remark\n      // );\n      invalidate(\n        remark.remark,\n        `[${OP_TYPES.CHANGEISSUER}] Dead before instantiation: ${ci}`\n      );\n      return true;\n    }\n    const coll = this.collections.find((el: C100) => el.id === ci.id);\n    if (!coll) {\n      invalidate(\n        ci.id,\n        `This ${OP_TYPES.CHANGEISSUER} remark is invalid - no such collection with ID ${ci.id} found before block ${remark.block}!`\n      );\n      return true;\n    }\n\n    if (remark.caller != coll.issuer) {\n      invalidate(\n        ci.id,\n        `Attempting to change issuer of collection ${ci.id} when not issuer!`\n      );\n      return true;\n    }\n\n    coll.addChange({\n      field: \"issuer\",\n      old: coll.issuer,\n      new: ci.issuer,\n      caller: remark.caller,\n      block: remark.block,\n    } as Change);\n\n    coll.issuer = ci.issuer;\n    return false;\n  }\n\n  public consolidate(): void {\n    const remarks = this.adapter.getRemarks();\n    //console.log(remarks);\n    for (const remark of remarks) {\n      console.log(\"==============================\");\n      console.log(\"Remark is: \" + remark.remark);\n      switch (remark.interaction_type) {\n        case OP_TYPES.MINT:\n          if (this.mint(remark)) {\n            continue;\n          }\n          break;\n\n        case OP_TYPES.MINTNFT:\n          if (this.mintNFT(remark)) {\n            continue;\n          }\n          break;\n\n        case OP_TYPES.SEND:\n          if (this.send(remark)) {\n            continue;\n          }\n          break;\n\n        case OP_TYPES.BUY:\n          // An NFT was bought after being LISTed\n          break;\n\n        case OP_TYPES.LIST:\n          // An NFT was listed for sale\n          break;\n\n        case OP_TYPES.EMOTE:\n          if (this.emote(remark)) {\n            continue;\n          }\n          break;\n\n        case OP_TYPES.CHANGEISSUER:\n          if (this.changeIssuer(remark)) {\n            continue;\n          }\n          break;\n\n        default:\n          console.error(\n            \"Unable to process this remark - wrong type: \" +\n              remark.interaction_type\n          );\n      }\n    }\n    deeplog(this.nfts);\n    deeplog(this.collections);\n    console.log(this.invalidCalls);\n  }\n}\n\ntype InvalidCall = {\n  message: string;\n  caller: string;\n  block: number;\n  object_id: string;\n  op_type: string;\n};\n"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","DisplayType","C100","decodeAddress","u8aToHex","N100"],"mappings":"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"}